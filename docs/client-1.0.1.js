!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./config"),g=a("./util"),h=function(){function a(b,c){d(this,a),this._gfx=new PIXI.Container;var e=f.mazes[c].color;this._grid=f.mazes[c].grid,this._respawnPoints=f.mazes[c].respawnPoints,this._wallImgs=new PIXI.Container;for(var g=0;g<this._grid.length;g++)for(var h=this._grid[g],i=0;i<h.length;i++){var j=this._grid[g][i];if(1===j){var k=new PIXI.Graphics;k.beginFill(e),k.drawRect(i*f.wallSize,g*f.wallSize,f.wallSize,f.wallSize),k.endFill(),this._wallImgs.addChild(k)}else if(2===j){var l=new PIXI.Graphics;l.beginFill(16755455),l.drawRect(i*f.wallSize,g*f.wallSize+f.wallSize/2,f.wallSize,f.dotSize),l.endFill(),this._wallImgs.addChild(l)}}this._gfx.addChild(this._wallImgs);for(var m=[],n=1;5>=n;n++){var o="energizer"+n+".png";m.push({texture:PIXI.Texture.fromFrame(o),time:50})}for(var n=4;n>=2;n--){var o="energizer"+n+".png";m.push({texture:PIXI.Texture.fromFrame(o),time:50})}this._dotImgs=new PIXI.Container,this._energizerClips=new PIXI.Container;for(var g=0;g<this._grid.length;g++)for(var h=this._grid[g],i=0;i<h.length;i++){var p=this._grid[g][i];switch(p){case 3:var q=new PIXI.Graphics;q.beginFill(15658734),q.drawRect(0,0,f.dotSize,f.dotSize);var r=f.wallSize/2-f.dotSize/2;q.x=i*f.wallSize+r,q.y=g*f.wallSize+r,this._dotImgs.addChild(q);break;case 4:var s=new PIXI.extras.MovieClip(m),t=1;s.x=i*f.wallSize+t,s.y=g*f.wallSize+t,s.play(),this._energizerClips.addChild(s)}}this._gfx.addChild(this._dotImgs),this._gfx.addChild(this._energizerClips),b.addChild(this._gfx)}return e(a,[{key:"tryMove",value:function(a,b,c,d,e,h){var i=!1,j=a,k=b,l=!1,m=c+e-1,n=d+h-1,o=g.convertToTileSpace(c),p=g.convertToTileSpace(m),q=g.convertToTileSpace(d),r=g.convertToTileSpace(n),s=this.isWallOpen(o,q),t=this.isWallOpen(p,q),u=this.isWallOpen(o,r),v=this.isWallOpen(p,r);return s&&t&&u&&v?(i=!0,j=c,k=d):c!=a?(k=d,a>c?-1===o?j=27*f.wallSize-1:(j=p*f.wallSize,l=!0):28===p?j=1:(j=o*f.wallSize,l=!0)):d!=b&&(j=c,b>d?(k=r*f.wallSize,l=!0):(k=q*f.wallSize,l=!0)),{success:i,finalx:j,finaly:k,doStop:l}}},{key:"isWallOpen",value:function(a,b){var c=this._grid[b];if(void 0!==c){var d=c[a];if(void 0!==d)return 1!==d&&2!==d}return!1}},{key:"handleDotCollision",value:function(a,b,c,d){return this._handleCollision(a,b,c,d,this._dotImgs)}},{key:"handleEnergizerCollision",value:function(a,b,c,d){return this._handleCollision(a,b,c,d,this._energizerClips)}},{key:"dotsLeft",value:function(){return this._dotImgs.children.length>0||this._energizerClips.children.length>0}},{key:"_handleCollision",value:function(a,b,c,d,e){for(var f=!1,h=e.children.length-1;h>=0;h--){var i=e.getChildAt(h);g.overlap(a,b,a+c,b+d,i.x,i.y,i.x+i.width,i.y+i.height)&&(e.removeChildAt(h),f=!0)}return f}},{key:"respawnPoints",get:function(){return this._respawnPoints}}]),a}();b.exports=h},{"./config":5,"./util":30}],2:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a){a.anchor.x=.5,a.anchor.y=.5,a.position.x=i.characterAnimationOffset,a.position.y=i.characterAnimationOffset}var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./entity-animation"),h=a("./event-bus"),i=a("./config"),j=a("./util"),k=function(){function a(b){var c=this;d(this,a),this._gfx=b,this._animations=[],this._handlePause=function(){var a=!0,b=!1,d=void 0;try{for(var e,f=c._animations[Symbol.iterator]();!(a=(e=f.next()).done);a=!0){var g=e.value;g.pause()}}catch(h){b=!0,d=h}finally{try{!a&&f["return"]&&f["return"]()}finally{if(b)throw d}}},this._handleResume=function(){var a=!0,b=!1,d=void 0;try{for(var e,f=c._animations[Symbol.iterator]();!(a=(e=f.next()).done);a=!0){var g=e.value;g.resume()}}catch(h){b=!0,d=h}finally{try{!a&&f["return"]&&f["return"]()}finally{if(b)throw d}}}}return f(a,[{key:"start",value:function(){h.register("event.pause.begin",this._handlePause),h.register("event.pause.end",this._handleResume)}},{key:"stop",value:function(){h.unregister("event.pause.begin",this._handlePause),h.unregister("event.pause.end",this._handleResume)}},{key:"createPacManAnimations",value:function(){for(var a=[],b=["player1.png","player2.png","player3.png","player2.png"],c=0;c<b.length;c++){var d=b[c];a.push({texture:PIXI.Texture.fromFrame(d),time:50})}var f=new PIXI.extras.MovieClip(a);e(f),f.rotation=1.5*Math.PI;var h=new PIXI.extras.MovieClip(a);e(h),h.rotation=Math.PI/2;var i=new PIXI.extras.MovieClip(a);e(i),i.scale.x=-1;var j=new PIXI.extras.MovieClip(a);e(j);var k=new PIXI.extras.MovieClip([PIXI.Texture.EMPTY]),l=new PIXI.extras.MovieClip([PIXI.Texture.EMPTY]),m=new g(this._gfx,f,h,i,j,k,l);return this._animations.push(m),m}},{key:"createGhostAnimations",value:function(a){var b=new PIXI.filters.ColorMatrixFilter;b.matrix=j.generateColorMatrixValue(a);for(var c=[],d=["shade-green-up1.png","shade-green-up2.png","shade-green-up3.png"],f=0;f<d.length;f++){var h=d[f];c.push({texture:PIXI.Texture.fromFrame(h),time:50})}var i=new PIXI.extras.MovieClip(c);i.filters=[b],e(i);for(var k=[],l=["shade-green-down1.png","shade-green-down2.png","shade-green-down3.png"],m=0;m<l.length;m++){var h=l[m];k.push({texture:PIXI.Texture.fromFrame(h),time:50})}var n=new PIXI.extras.MovieClip(k);n.filters=[b],e(n);for(var o=[],p=["shade-green-right1.png","shade-green-right2.png","shade-green-right3.png"],q=0;q<p.length;q++){var h=p[q];o.push({texture:PIXI.Texture.fromFrame(h),time:50})}var r=new PIXI.extras.MovieClip(o);r.filters=[b],e(r),r.scale.x=-1;var s=new PIXI.extras.MovieClip(o);s.filters=[b],e(s);for(var t=[],u=["shade-frightened1.png","shade-frightened2.png","shade-frightened3.png"],v=0;v<u.length;v++){var h=u[v];t.push({texture:PIXI.Texture.fromFrame(h),time:50})}var w=new PIXI.extras.MovieClip(t);e(w);for(var x=[],y=["shade-frightened1.png","shade-frightened2.png","shade-frightened3.png","shade-flash1.png","shade-flash2.png","shade-flash3.png"],z=0;z<y.length;z++){var h=y[z];x.push({texture:PIXI.Texture.fromFrame(h),time:83.34})}var A=new PIXI.extras.MovieClip(x);e(A);var B=new g(this._gfx,i,n,r,s,w,A);return this._animations.push(B),B}}]),a}();b.exports=k},{"./config":5,"./entity-animation":7,"./event-bus":9,"./util":30}],3:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b,c){var d=Math.random()*c+(a-c/2),e=Math.random()*c+(b-c/2);return{x:d,y:e}}function f(){return Math.random()*(q-p)+p}function g(a,b){var c=h(a),d=c.dx,e=c.dy,f=h(b),g=f.dx,j=f.dy,k=d+g,l=e+j;if(0===k&&0===l){var o=i();"left"===a||"right"===a||"left"===b||"right"===b?l=o:k=o}var p=k/2,q=l/2,r=Math.random()*(n-m)+m,s=Math.random()*(n-m)+m,t=p*r,u=q*s;return 0===t&&(t=Math.random()*u-u/2),0===u&&(u=Math.random()*t-t/2),{xenergy:t,yenergy:u}}function h(a){var b=0,c=0;switch(a){case"up":c=-1;break;case"down":c=1;break;case"left":b=-1;break;case"right":b=1}return{dx:b,dy:c}}function i(){var a=Math.random();return.5>a?-1:1}var j=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),k=a("./event-bus"),l=3,m=1.5,n=12.5,o=0,p=300,q=600,r=function(){function a(b,c,e,f,g,h,i){d(this,a),this._parentGfx=b,this._gfx=new PIXI.Sprite(c),b.addChild(this._gfx),this._gfx.x=e,this._gfx.y=f,this._ttl=g,this._xenergy=h,this._yenergy=i}return j(a,[{key:"step",value:function(a){return this._ttl-=a,this._ttl<=0?(this._remove(),!1):(this._update(),!0)}},{key:"_remove",value:function(){this._parentGfx.removeChild(this._gfx)}},{key:"_update",value:function(){this._gfx.x+=this._xenergy,this._xenergy<0?this._xenergy+=o:this._xenergy-=o,this._gfx.y+=this._yenergy,this._yenergy<0?this._yenergy+=o:this._yenergy-=o}}]),a}(),s=function(){function a(b){d(this,a),this._parentGfx=b,this._gfx=new PIXI.Container,b.addChild(this._gfx),this._blueParticles=[],this._blueGfx=new PIXI.ParticleContainer,this._gfx.addChild(this._blueGfx);var c=new PIXI.Graphics;c.lineStyle(1,1442014,1),c.beginFill(4474111,1),c.drawRect(0,0,l,l),c.endFill(),this._blueTexture=c.generateTexture(),this._yellowParticles=[],this._yellowGfx=new PIXI.ParticleContainer,this._gfx.addChild(this._yellowGfx);var e=new PIXI.Graphics;e.lineStyle(1,16577536),e.beginFill(13355776,1),e.drawRect(0,0,l,l),e.endFill(),this._yellowTexture=e.generateTexture()}return j(a,[{key:"start",value:function(){var a=this;this._handleDeathGhost=function(b){a._emitExplosion(a._blueParticles,a._blueGfx,a._blueTexture,b.x,b.y,b.ghostDirection,b.pacmanDirection)},k.register("event.action.death.ghost",this._handleDeathGhost),this._handleDeathPacman=function(b){a._emitExplosion(a._yellowParticles,a._yellowGfx,a._yellowTexture,b.x,b.y,b.ghostDirection,b.pacmanDirection)},k.register("event.action.death.pacman",this._handleDeathPacman)}},{key:"step",value:function(a){this._blueParticles=this._blueParticles.filter(function(b){return b.step(a)}),this._yellowParticles=this._yellowParticles.filter(function(b){return b.step(a)})}},{key:"stop",value:function(){k.unregister("event.action.death.ghost",this._handleDeathGhost),k.unregister("event.action.death.pacman",this._handleDeathPacman),this._parentGfx.removeChild(this._gfx)}},{key:"_emitExplosion",value:function(a,b,c,d,h,i,j){for(var k=0;100>k;k++){var l=e(d,h,45),m=l.x,n=l.y,o=g(i,j),p=o.xenergy,q=o.yenergy;a.push(new r(b,c,m,n,f(),p,q))}}}]),a}();b.exports=s},{"./event-bus":9}],4:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(){var a=["left","right"],b=l.getRandomIntInclusive(0,a.length-1);return a[b]}var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./entity"),h=a("./character-animations"),i=a("./movement-strategy"),j=a("./death"),k=a("./config"),l=a("./util"),m=a("./long-tasks"),n=a("./event-bus"),o=function(){function a(b,c,e){d(this,a),this._board=b,this._longTasksManager=e,this._gfx=new PIXI.Container,c.addChild(this._gfx),this._characterAnimations=new h(this._gfx),this._pacman=new g("pacman",b,k.startpacmanx,k.startpacmany,this._characterAnimations.createPacManAnimations(),new i(b,"doNothing","doNothing"),!0),this._ghosts=[],this._blinky=new g("blinky",b,k.startghostx+3*k.wallSize,k.startghosty,this._characterAnimations.createGhostAnimations("red"),new i(b,"blinky","random",27,1,this._pacman),!1),this._ghosts.push(this._blinky),this._pinky=new g("pinky",b,k.startghostx-3*k.wallSize,k.startghosty,this._characterAnimations.createGhostAnimations("pink"),new i(b,"pinky","random",1,1,this._pacman),!1),this._ghosts.push(this._pinky),this._inky=new g("inky",b,k.startghostx+k.wallSize,k.startghosty,this._characterAnimations.createGhostAnimations("blue"),new i(b,"inky","random",27,30,this._pacman,this._blinky),!1),this._ghosts.push(this._inky),this._clyde=new g("clyde",b,k.startghostx-k.wallSize,k.startghosty,this._characterAnimations.createGhostAnimations("orange"),new i(b,"clyde","random",1,30,this._pacman),!1),this._ghosts.push(this._clyde)}return f(a,[{key:"start",value:function(a){this._characterAnimations.start();var b=a.speedGroup,c=a.ghostMode[0].mode;this._pacman.start(b.pacmanNormal,b.pacmanFright,"","left",a.frightTime,a.frightFlashes),this._blinky.start(b.ghostNormal,b.ghostFright,c,e(),a.frightTime,a.frightFlashes),this._pinky.start(b.ghostNormal,b.ghostFright,c,e(),a.frightTime,a.frightFlashes),this._inky.start(b.ghostNormal,b.ghostFright,c,e(),a.frightTime,a.frightFlashes),this._clyde.start(b.ghostNormal,b.ghostFright,c,e(),a.frightTime,a.frightFlashes)}},{key:"stop",value:function(){this._characterAnimations.stop()}},{key:"checkCollisions",value:function(){var a=!1,b=!1,c=!1;return this._pacman.solid&&(this._board.handleDotCollision(this._pacman.x,this._pacman.y,this._pacman.width,this._pacman.height)&&(b=!0,a=!0),this._board.handleEnergizerCollision(this._pacman.x,this._pacman.y,this._pacman.width,this._pacman.height)&&(b=!0,c=!0),this._handleGhostCollision()&&(b=!0)),{x:this._pacman.x,y:this._pacman.y,dot:a,collision:b,energizer:c}}},{key:"stepPacman",value:function(a,b){null!==b&&(this._pacman.requestedDirection=b),this._pacman.step(a)}},{key:"stepGhosts",value:function(a){var b=!0,c=!1,d=void 0;try{for(var e,f=this._ghosts[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value;g.step(a)}}catch(h){c=!0,d=h}finally{try{!b&&f["return"]&&f["return"]()}finally{if(c)throw d}}}},{key:"switchMode",value:function(a){var b=!0,c=!1,d=void 0;try{for(var e,f=this._ghosts[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value;g.mode=a,g.reverseNeeded=!0}}catch(h){c=!0,d=h}finally{try{!b&&f["return"]&&f["return"]()}finally{if(c)throw d}}}},{key:"signalFright",value:function(){this._pacman.signalFrightened();var a=!0,b=!1,c=void 0;try{for(var d,e=this._ghosts[Symbol.iterator]();!(a=(d=e.next()).done);a=!0){var f=d.value;f.signalFrightened(),f._reverseNeeded=!0}}catch(g){b=!0,c=g}finally{try{!a&&e["return"]&&e["return"]()}finally{if(b)throw c}}}},{key:"removeRemainingFright",value:function(){this._pacman.removeFrightIfAny();var a=!0,b=!1,c=void 0;try{for(var d,e=this._ghosts[Symbol.iterator]();!(a=(d=e.next()).done);a=!0){var f=d.value;f.removeFrightIfAny()}}catch(g){b=!0,c=g}finally{try{!a&&e["return"]&&e["return"]()}finally{if(b)throw c}}}},{key:"determineCurrentDirection",value:function(){return this._pacman.currentDirection}},{key:"_handleGhostCollision",value:function(){var a=!0,b=!1,c=void 0;try{for(var d,e=this._ghosts[Symbol.iterator]();!(a=(d=e.next()).done);a=!0){var f=d.value;if(f.solid!==!1&&l.overlap(this._pacman.x,this._pacman.y,this._pacman.x+this._pacman.width,this._pacman.y+this._pacman.height,f.x,f.y,f.x+f.width,f.y+f.height))return f.frightened?(this._killGhost(f),!0):(this._killPacman(f),!0)}}catch(g){b=!0,c=g}finally{try{!a&&e["return"]&&e["return"]()}finally{if(b)throw c}}}},{key:"_killGhost",value:function(a){var b=new j.Ghost(a);b.start(),this._longTasksManager.addTask(new m.TimeoutTask(500,function(){b.respawn()})),n.fire({name:"event.action.death.ghost",args:{x:a.x,y:a.y,ghostName:a.name,ghostDirection:a.currentDirection,pacmanDirection:this._pacman.currentDirection}}),n.fire({name:"event.screenshake.start"})}},{key:"_killPacman",value:function(a){var b=this,c=new j.Pacman(this._pacman,this._ghosts,this._board);c.start(),this._longTasksManager.addTask(new m.TimeoutTask(1e3,function(){c.respawn();var a=0,d=0,e=b,f=function(){return a+=1,9>a?(d=0===d?1:0,e._pacman.alpha=d,!0):(e._pacman.alpha=1,!1)};b._longTasksManager.addTask(new m.IntervalTask(50,f))})),n.fire({name:"event.action.death.pacman",args:{x:this._pacman.x,y:this._pacman.y,ghostName:a.name,ghostDirection:a.currentDirection,pacmanDirection:this._pacman.currentDirection}}),n.fire({name:"event.screenshake.start"})}}]),a}();b.exports=o},{"./character-animations":2,"./config":5,"./death":6,"./entity":8,"./event-bus":9,"./long-tasks":17,"./movement-strategy":19,"./util":30}],5:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a),this.wallSize=16,this.dotSize=4,this.characterAnimationOffset=7,this.startpacmanx=13*this.wallSize+this.wallSize/2,this.startpacmany=23*this.wallSize,this.startghostx=13*this.wallSize+this.wallSize/2,this.startghosty=11*this.wallSize,this.topSpeed=.16,this.pacmanTurnSpeedIncrease=2,this.pacmanTurnSpeedLength=50,this.ghostModes=[[{mode:"scatter",time:7e3},{mode:"chase",time:2e4},{mode:"scatter",time:7e3},{mode:"chase",time:2e4},{mode:"scatter",time:5e3},{mode:"chase",time:2e4},{mode:"scatter",time:5e3},{mode:"chase",time:Number.MAX_SAFE_INTEGER}],[{mode:"scatter",time:7e3},{mode:"chase",time:2e4},{mode:"scatter",time:7e3},{mode:"chase",time:2e4},{mode:"scatter",time:5e3},{mode:"chase",time:1033e3},{mode:"scatter",time:16},{mode:"chase",time:Number.MAX_SAFE_INTEGER}],[{mode:"scatter",time:5e3},{mode:"chase",time:2e4},{mode:"scatter",time:5e3},{mode:"chase",time:2e4},{mode:"scatter",time:5e3},{mode:"chase",time:1037e3},{mode:"scatter",time:16},{mode:"chase",time:Number.MAX_SAFE_INTEGER}]],this.speedGroups=[{pacmanNormal:.8,pacmanFright:.9,ghostNormal:.75,ghostFright:.5,ghostTunnel:.4},{pacmanNormal:.9,pacmanFright:.95,ghostNormal:.85,ghostFright:.55,ghostTunnel:.45},{pacmanNormal:1,pacmanFright:1,ghostNormal:.95,ghostFright:.6,ghostTunnel:.5},{pacmanNormal:1,pacmanFright:1,ghostNormal:.95,ghostFright:.6,ghostTunnel:.5}],this.levelSpecifications=[{bonusSymbol:"cherries",bonusPoints:100,ghostMode:this.ghostModes[0],speedGroup:this.speedGroups[0],frightTime:6e3,frightFlashes:5,elroy1DotsLeft:20,elroy2DotsLeft:10},{bonusSymbol:"strawberry",bonusPoints:300,ghostMode:this.ghostModes[1],speedGroup:this.speedGroups[1],frightTime:5e3,frightFlashes:5,elroy1DotsLeft:30,elroy2DotsLeft:15},{bonusSymbol:"peach",bonusPoints:500,ghostMode:this.ghostModes[1],speedGroup:this.speedGroups[1],frightTime:4e3,frightFlashes:5,elroy1DotsLeft:40,elroy2DotsLeft:20},{bonusSymbol:"peach",bonusPoints:500,ghostMode:this.ghostModes[1],speedGroup:this.speedGroups[1],frightTime:3e3,frightFlashes:5,elroy1DotsLeft:40,elroy2DotsLeft:20},{bonusSymbol:"apple",bonusPoints:700,ghostMode:this.ghostModes[2],speedGroup:this.speedGroups[2],frightTime:2e3,frightFlashes:5,elroy1DotsLeft:40,elroy2DotsLeft:20}],this.mazes=[],this._initMazes()}return e(a,[{key:"lastLevelIndex",value:function(){return this.levelSpecifications.length-1}},{key:"_initMazes",value:function(){this.mazes=[];var a=2,b=3,c=4,d={color:21981,respawnPoints:[{x:6,y:5},{x:21,y:5},{x:6,y:14},{x:21,y:14},{x:6,y:20},{x:21,y:20}],grid:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,b,b,b,b,b,b,b,b,b,b,b,b,1,1,b,b,b,b,b,b,b,b,b,b,b,b,1],[1,b,1,1,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,1,1,b,1],[1,c,1,1,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,1,1,c,1],[1,b,1,1,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,1,1,b,1],[1,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,1],[1,b,1,1,1,1,b,1,1,b,1,1,1,1,1,1,1,1,b,1,1,b,1,1,1,1,b,1],[1,b,1,1,1,1,b,1,1,b,1,1,1,1,1,1,1,1,b,1,1,b,1,1,1,1,b,1],[1,b,b,b,b,b,b,1,1,b,b,b,b,1,1,b,b,b,b,1,1,b,b,b,b,b,b,1],[1,1,1,1,1,1,b,1,1,1,1,1,0,1,1,0,1,1,1,1,1,b,1,1,1,1,1,1],[1,1,1,1,1,1,b,1,1,1,1,1,0,1,1,0,1,1,1,1,1,b,1,1,1,1,1,1],[1,1,1,1,1,1,b,1,1,0,0,0,0,0,0,0,0,0,0,1,1,b,1,1,1,1,1,1],[1,1,1,1,1,1,b,1,1,0,1,1,1,a,a,1,1,1,0,1,1,b,1,1,1,1,1,1],[1,1,1,1,1,1,b,1,1,0,1,0,0,0,0,0,0,1,0,1,1,b,1,1,1,1,1,1],[0,0,0,0,0,0,b,0,0,0,1,0,0,0,0,0,0,1,0,0,0,b,0,0,0,0,0,0],[1,1,1,1,1,1,b,1,1,0,1,0,0,0,0,0,0,1,0,1,1,b,1,1,1,1,1,1],[1,1,1,1,1,1,b,1,1,0,1,1,1,1,1,1,1,1,0,1,1,b,1,1,1,1,1,1],[1,1,1,1,1,1,b,1,1,0,0,0,0,0,0,0,0,0,0,1,1,b,1,1,1,1,1,1],[1,1,1,1,1,1,b,1,1,0,1,1,1,1,1,1,1,1,0,1,1,b,1,1,1,1,1,1],[1,1,1,1,1,1,b,1,1,0,1,1,1,1,1,1,1,1,0,1,1,b,1,1,1,1,1,1],[1,b,b,b,b,b,b,b,b,b,b,b,b,1,1,b,b,b,b,b,b,b,b,b,b,b,b,1],[1,b,1,1,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,1,1,b,1],[1,b,1,1,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,1,1,b,1],[1,c,b,b,1,1,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,1,1,b,b,c,1],[1,1,1,b,1,1,b,1,1,b,1,1,1,1,1,1,1,1,b,1,1,b,1,1,b,1,1,1],[1,1,1,b,1,1,b,1,1,b,1,1,1,1,1,1,1,1,b,1,1,b,1,1,b,1,1,1],[1,b,b,b,b,b,b,1,1,b,b,b,b,1,1,b,b,b,b,1,1,b,b,b,b,b,b,1],[1,b,1,1,1,1,1,1,1,1,1,1,b,1,1,b,1,1,1,1,1,1,1,1,1,1,b,1],[1,b,1,1,1,1,1,1,1,1,1,1,b,1,1,b,1,1,1,1,1,1,1,1,1,1,b,1],[1,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]};this.mazes.push(d);var e={color:16561320,respawnPoints:[{x:6,y:4},{x:21,y:4},{x:3,y:17},{x:24,y:17}],grid:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,b,b,b,b,b,b,1,1,b,b,b,b,b,b,b,b,b,b,1,1,b,b,b,b,b,b,1],[1,c,1,1,1,1,b,1,1,b,1,1,1,1,1,1,1,1,b,1,1,b,1,1,1,1,c,1],[1,b,1,1,1,1,b,1,1,b,1,1,1,1,1,1,1,1,b,1,1,b,1,1,1,1,b,1],[1,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,1],[1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1],[1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1],[1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1],[0,0,0,b,1,1,b,b,b,b,b,b,b,1,1,b,b,b,b,b,b,b,1,1,b,0,0,0],[1,1,1,b,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,b,1,1,1],[1,1,1,b,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,b,1,1,1],[1,1,1,b,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,b,1,1,1],[1,1,1,b,1,1,1,1,1,0,1,1,1,2,2,1,1,1,0,1,1,1,1,1,b,1,1,1],[1,1,1,b,1,1,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,1,1,b,1,1,1],[1,1,1,b,1,1,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,1,b,1,1,1],[1,1,1,b,1,1,0,1,1,0,1,0,0,0,0,0,0,1,0,1,1,0,1,1,b,1,1,1],[1,1,1,b,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,1,1,b,1,1,1],[0,0,0,b,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,b,0,0,0],[1,1,1,b,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,b,1,1,1],[1,1,1,b,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,b,1,1,1],[1,1,1,b,b,b,b,b,b,b,0,0,0,1,1,0,0,0,b,b,b,b,b,b,b,1,1,1],[1,1,1,b,1,1,1,1,1,b,1,1,1,1,1,1,1,1,b,1,1,1,1,1,b,1,1,1],[1,1,1,b,1,1,1,1,1,b,1,1,1,1,1,1,1,1,b,1,1,1,1,1,b,1,1,1],[1,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,1],[1,b,1,1,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,1,1,b,1],[1,b,1,1,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,1,1,b,1],[1,b,1,1,1,1,b,1,1,b,b,b,b,1,1,b,b,b,b,1,1,b,1,1,1,1,b,1],[1,c,1,1,1,1,b,1,1,b,1,1,1,1,1,1,1,1,b,1,1,b,1,1,1,1,c,1],[1,b,1,1,1,1,b,1,1,b,1,1,1,1,1,1,1,1,b,1,1,b,1,1,1,1,b,1],[1,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]};this.mazes.push(e);var f={color:4896255,respawnPoints:[{x:9,y:4},{x:18,y:4},{x:3,y:23},{x:24,y:23}],grid:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,1,1,b,b,b,b,b,b,b,b,b,b,1,1,0,0,0,0,0,0,0],[1,1,1,1,1,1,0,1,1,b,1,1,1,1,1,1,1,1,b,1,1,0,1,1,1,1,1,1],[1,1,1,1,1,1,0,1,1,b,1,1,1,1,1,1,1,1,b,1,1,0,1,1,1,1,1,1],[1,c,b,b,b,b,b,b,b,b,b,b,b,1,1,b,b,b,b,b,b,b,b,b,b,b,c,1],[1,b,1,1,1,1,1,1,1,b,1,1,b,1,1,b,1,1,b,1,1,1,1,1,1,1,b,1],[1,b,1,1,1,1,1,1,1,b,1,1,b,1,1,b,1,1,b,1,1,1,1,1,1,1,b,1],[1,b,1,1,b,b,b,b,b,b,1,1,b,1,1,b,1,1,b,b,b,b,b,b,1,1,b,1],[1,b,1,1,b,1,1,1,1,0,1,1,b,b,b,b,1,1,0,1,1,1,1,b,1,1,b,1],[1,b,1,1,b,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,b,1,1,b,1],[1,b,b,b,b,b,b,1,1,0,1,1,1,1,1,1,1,1,0,1,1,b,b,b,b,b,b,1],[1,1,1,1,1,1,b,1,1,0,0,0,0,0,0,0,0,0,0,1,1,b,1,1,1,1,1,1],[1,1,1,1,1,1,b,1,1,0,1,1,1,2,2,1,1,1,0,1,1,b,1,1,1,1,1,1],[1,b,b,b,b,b,b,1,1,0,1,0,0,0,0,0,0,1,0,1,1,b,b,b,b,b,b,1],[1,b,1,1,1,1,b,1,1,0,1,0,0,0,0,0,0,1,0,1,1,b,1,1,1,1,b,1],[1,b,1,1,1,1,b,0,0,0,1,0,0,0,0,0,0,1,0,0,0,b,1,1,1,1,b,1],[1,b,b,b,1,1,b,1,1,0,1,1,1,1,1,1,1,1,0,1,1,b,1,1,b,b,b,1],[1,1,1,b,1,1,b,1,1,0,0,0,0,0,0,0,0,0,0,1,1,b,1,1,b,1,1,1],[1,1,1,b,1,1,b,1,1,1,1,0,1,1,1,1,0,1,1,1,1,b,1,1,b,1,1,1],[1,1,1,b,1,1,b,1,1,1,1,0,1,1,1,1,0,1,1,1,1,b,1,1,b,1,1,1],[1,1,1,b,b,b,b,b,b,b,b,b,1,1,1,1,b,b,b,b,b,b,b,b,b,1,1,1],[1,1,1,b,1,1,1,1,1,1,1,b,1,1,1,1,b,1,1,1,1,1,1,1,b,1,1,1],[1,1,1,b,1,1,1,1,1,1,1,b,1,1,1,1,b,1,1,1,1,1,1,1,b,1,1,1],[0,0,0,b,b,b,b,1,1,b,b,b,0,0,0,0,b,b,b,1,1,b,b,b,b,0,0,0],[1,1,1,b,1,1,b,1,1,b,1,1,1,1,1,1,1,1,b,1,1,b,1,1,b,1,1,1],[1,1,1,b,1,1,b,1,1,b,1,1,1,1,1,1,1,1,b,1,1,b,1,1,b,1,1,1],[1,c,b,b,1,1,b,b,b,b,b,b,b,1,1,b,b,b,b,b,b,b,1,1,b,b,c,1],[1,b,1,1,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,1,1,b,1],[1,b,1,1,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,1,1,b,1],[1,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]};this.mazes.push(f);var g={color:14192725,respawnPoints:[{x:4,y:9},{x:23,y:9},{x:6,y:17},{x:21,y:17},{x:6,y:23},{x:21,y:23}],grid:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,b,b,b,b,b,b,b,b,b,1,1,b,b,b,b,1,1,b,b,b,b,b,b,b,b,b,1],[1,b,1,1,1,1,1,1,1,b,1,1,b,1,1,b,1,1,b,1,1,1,1,1,1,1,b,1],[1,c,1,1,1,1,1,1,1,b,1,1,b,1,1,b,1,1,b,1,1,1,1,1,1,1,c,1],[1,b,1,1,b,b,b,b,b,b,b,b,b,1,1,b,b,b,b,b,b,b,b,b,1,1,b,1],[1,b,1,1,b,1,1,b,1,1,1,1,b,1,1,b,1,1,1,1,b,1,1,b,1,1,b,1],[1,b,b,b,b,1,1,b,1,1,1,1,b,1,1,b,1,1,1,1,b,1,1,b,b,b,b,1],[1,1,1,1,b,1,1,b,1,1,1,1,b,1,1,b,1,1,1,1,b,1,1,b,1,1,1,1],[1,1,1,1,b,1,1,b,b,b,b,b,b,b,b,b,b,b,b,b,b,1,1,b,1,1,1,1],[0,b,b,b,b,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,b,b,b,b,0],[1,b,1,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,b,1,1,b,1],[1,b,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,b,1],[1,b,1,1,1,1,0,1,1,0,1,1,1,2,2,1,1,1,0,1,1,0,1,1,1,1,b,1],[1,b,1,1,1,1,0,1,1,0,1,0,0,0,0,0,0,1,0,1,1,0,1,1,1,1,b,1],[1,b,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,1,0,1,1,0,0,0,0,0,b,1],[1,b,1,1,0,1,1,1,1,0,1,0,0,0,0,0,0,1,0,1,1,1,1,0,1,1,b,1],[1,b,1,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,0,1,1,b,1],[1,b,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,b,1],[1,b,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,b,1],[1,b,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,b,1],[1,b,b,b,b,b,b,1,1,b,b,b,b,1,1,b,b,b,b,1,1,b,b,b,b,b,b,1],[1,1,1,b,1,1,b,1,1,b,1,1,1,1,1,1,1,1,b,1,1,b,1,1,b,1,1,1],[1,1,1,b,1,1,b,1,1,b,1,1,1,1,1,1,1,1,b,1,1,b,1,1,b,1,1,1],[1,c,b,b,1,1,b,b,b,b,b,b,b,0,0,b,b,b,b,b,b,b,1,1,b,b,c,1],[1,b,1,1,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,1,1,b,1],[1,b,1,1,1,1,b,1,1,1,1,1,b,1,1,b,1,1,1,1,1,b,1,1,1,1,b,1],[1,b,b,b,b,b,b,1,1,b,b,b,b,1,1,b,b,b,b,1,1,b,b,b,b,b,b,1],[1,b,1,1,1,1,b,1,1,b,1,1,1,1,1,1,1,1,b,1,1,b,1,1,1,1,b,1],[1,b,1,1,1,1,b,1,1,b,1,1,1,1,1,1,1,1,b,1,1,b,1,1,1,1,b,1],[1,b,b,b,b,b,b,1,1,b,b,b,b,b,b,b,b,b,b,1,1,b,b,b,b,b,b,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]};this.mazes.push(g);var h={color:8892506,respawnPoints:[{x:6,y:5},{x:21,y:5},{x:6,y:18},{x:21,y:18},{x:9,y:23},{x:18,y:23}],grid:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,1],[1,b,1,1,b,1,1,1,1,b,1,1,1,1,1,1,1,1,b,1,1,1,1,b,1,1,b,1],[1,c,1,1,b,1,1,1,1,b,1,1,1,1,1,1,1,1,b,1,1,1,1,b,1,1,c,1],[1,b,1,1,b,1,1,1,1,b,1,1,b,b,b,b,1,1,b,1,1,1,1,b,1,1,b,1],[1,b,1,1,b,b,b,b,b,b,1,1,b,1,1,b,1,1,b,b,b,b,b,b,1,1,b,1],[1,b,1,1,1,1,b,1,1,b,1,1,b,1,1,b,1,1,b,1,1,b,1,1,1,1,b,1],[1,b,1,1,1,1,b,1,1,b,1,1,b,1,1,b,1,1,b,1,1,b,1,1,1,1,b,1],[1,b,b,b,b,b,b,1,1,b,b,b,b,1,1,b,b,b,b,1,1,b,b,b,b,b,b,1],[1,1,1,b,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,b,1,1,1],[1,1,1,b,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,b,1,1,1],[1,1,1,b,b,b,b,1,1,0,0,0,0,0,0,0,0,0,0,1,1,b,b,b,b,1,1,1],[1,1,1,0,1,1,b,1,1,0,1,1,1,2,2,1,1,1,0,1,1,b,1,1,0,1,1,1],[0,0,0,0,1,1,b,1,1,0,1,0,0,0,0,0,0,1,0,1,1,b,1,1,0,0,0,0],[1,1,1,1,1,1,b,0,0,0,1,0,0,0,0,0,0,1,0,0,0,b,1,1,1,1,1,1],[1,1,1,1,1,1,b,1,1,0,1,0,0,0,0,0,0,1,0,1,1,b,1,1,1,1,1,1],[0,0,0,0,1,1,b,1,1,0,1,1,1,1,1,1,1,1,0,1,1,b,1,1,0,0,0,0],[1,1,1,0,1,1,b,1,1,0,0,0,0,0,0,0,0,0,0,1,1,b,1,1,0,1,1,1],[1,1,1,b,b,b,b,1,1,1,1,1,0,1,1,0,1,1,1,1,1,b,b,b,b,1,1,1],[1,1,1,b,1,1,b,1,1,1,1,1,0,1,1,0,1,1,1,1,1,b,1,1,b,1,1,1],[1,1,1,b,1,1,b,b,b,b,0,0,0,1,1,0,0,0,b,b,b,b,1,1,b,1,1,1],[1,1,1,b,1,1,1,1,1,b,1,1,0,1,1,0,1,1,b,1,1,1,1,1,b,1,1,1],[1,1,1,b,1,1,1,1,1,b,1,1,0,1,1,0,1,1,b,1,1,1,1,1,b,1,1,1],[1,b,b,b,b,b,b,b,b,b,1,1,0,0,0,0,1,1,b,b,b,b,b,b,b,b,b,1],[1,b,1,1,1,1,b,1,1,b,1,1,1,1,1,1,1,1,b,1,1,b,1,1,1,1,b,1],[1,b,1,1,1,1,b,1,1,b,1,1,1,1,1,1,1,1,b,1,1,b,1,1,1,1,b,1],[1,b,1,1,b,b,b,1,1,b,b,b,b,b,b,b,b,b,b,1,1,b,b,b,1,1,b,1],[1,c,1,1,b,1,1,1,1,1,1,1,b,1,1,b,1,1,1,1,1,1,1,b,1,1,c,1],[1,b,1,1,b,1,1,1,1,1,1,1,b,1,1,b,1,1,1,1,1,1,1,b,1,1,b,1],[1,b,b,b,b,b,b,b,b,b,b,b,b,1,1,b,b,b,b,b,b,b,b,b,b,b,b,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]};this.mazes.push(h)}}]),a}(),g=new f;b.exports=g},{}],6:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b,c,d){var e=[],g=!0,j=!1,k=void 0;try{for(var l,m=d[Symbol.iterator]();!(g=(l=m.next()).done);g=!0){var n=l.value,o={x:n.x,y:n.y,ghostCount:0};e.push(o)}}catch(p){j=!0,k=p}finally{try{!g&&m["return"]&&m["return"]()}finally{if(j)throw k}}var q=7,r=!0,s=!1,t=void 0;try{for(var u,v=a[Symbol.iterator]();!(r=(u=v.next()).done);r=!0){var w=u.value,x=!0,y=!1,z=void 0;try{for(var A,B=e[Symbol.iterator]();!(x=(A=B.next()).done);x=!0){var o=A.value;f(o,q,w)&&o.ghostCount++}}catch(p){y=!0,z=p}finally{try{!x&&B["return"]&&B["return"]()}finally{if(y)throw z}}}}catch(p){s=!0,t=p}finally{try{!r&&v["return"]&&v["return"]()}finally{if(s)throw t}}e.sort(function(a,d){var e=i.qs(b-a.x*h.wallSize,c-a.y*h.wallSize),f=i.qs(b-d.x*h.wallSize,c-d.y*h.wallSize);return e-f});var C=null,D=!0,E=!1,F=void 0;try{for(var G,H=e[Symbol.iterator]();!(D=(G=H.next()).done);D=!0){var o=G.value;if(0===o.ghostCount){C=o;break}}}catch(p){E=!0,F=p}finally{try{!D&&H["return"]&&H["return"]()}finally{if(E)throw F}}return null===C&&(C=e[0]),C}function f(a,b,c){var d=a.x*h.wallSize,e=a.y*h.wallSize,f=d-b*h.wallSize,g=e-b*h.wallSize,j=d+(b+1)*h.wallSize,k=e+(b+1)*h.wallSize,l=c.x,m=c.y,n=c.x+c.width,o=c.y+c.height;return i.overlap(f,g,j,k,l,m,n,o)}var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./config"),i=a("./util"),j=function(){function a(b){d(this,a),this._ghost=b}return g(a,[{key:"start",value:function(){this._ghost.removeFrightIfAny(),this._ghost.solid=!1,this._ghost.visible=!1}},{key:"respawn",value:function(){this._ghost.solid=!0,this._ghost.visible=!0,this._ghost.x=h.startghostx,this._ghost.y=h.startghosty}}]),a}(),k=function(){function a(b,c,e){d(this,a),this._pacman=b,this._ghosts=c,this._board=e,this._deathx=-1,this._deathy=-1}return g(a,[{key:"start",value:function(){this._pacman.removeFrightIfAny(),this._pacman.solid=!1,this._pacman.visible=!1,this._deathx=this._pacman.x,this._deathy=this._pacman.y}},{key:"respawn",value:function(){this._pacman.solid=!0,this._pacman.visible=!0;var a=e(this._ghosts,this._deathx,this._deathy,this._board.respawnPoints);this._pacman.x=a.x*h.wallSize,this._pacman.y=a.y*h.wallSize,this._pacman.ensureRequestedDirectionActive()}}]),a}();c.Ghost=j,c.Pacman=k},{"./config":5,"./util":30}],7:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b,c,e,f,g,h,i){d(this,a),this._parentGfx=b,this._gfx=new PIXI.Container,b.addChild(this._gfx),this._up=c,this._gfx.addChild(c),this._down=e,this._gfx.addChild(e),this._left=f,this._gfx.addChild(f),this._right=g,this._gfx.addChild(g),this._frightened=h,this._gfx.addChild(h),this._flashing=i,this._gfx.addChild(i),this._directionals=[c,e,f,g],this._allclips=[c,e,f,g,h,i],this._frightTime=0,this._frightFlashes=0,this._frightTimeLeft=0}return e(a,[{key:"start",value:function(a,b){this.stopFrightened(),
this._frightTime=a,this._frightFlashes=b}},{key:"step",value:function(a){if(this._frightTimeLeft>0){this._frightTimeLeft-=a;var b=500*this._frightFlashes;this._frightTimeLeft<=b&&0==this._flashing.visible&&(this._frightened.visible=!1,this._frightened.stop(),this._flashing.visible=!0,this._flashing.gotoAndPlay(0))}}},{key:"stop",value:function(){}},{key:"pause",value:function(){var a=!0,b=!1,c=void 0;try{for(var d,e=this._allclips[Symbol.iterator]();!(a=(d=e.next()).done);a=!0){var f=d.value;f.playing&&(f.stop(),f.paused=!0)}}catch(g){b=!0,c=g}finally{try{!a&&e["return"]&&e["return"]()}finally{if(b)throw c}}}},{key:"resume",value:function(){var a=!0,b=!1,c=void 0;try{for(var d,e=this._allclips[Symbol.iterator]();!(a=(d=e.next()).done);a=!0){var f=d.value;f.paused&&(f.play(),f.paused=!1)}}catch(g){b=!0,c=g}finally{try{!a&&e["return"]&&e["return"]()}finally{if(b)throw c}}}},{key:"startFrightened",value:function(){this._frightTimeLeft=this._frightTime,this._frightened.visible=!0,this._frightened.gotoAndPlay(0),this._flashing.visible=!1,this._flashing.stop()}},{key:"stopFrightened",value:function(){this._frightTimeLeft=0,this._frightened.visible=!1,this._frightened.stop(),this._flashing.visible=!1,this._flashing.stop()}},{key:"changeDirection",value:function(a){if(""===a){var b=!0,c=!1,d=void 0;try{for(var e,f=this._directionals[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value;if(g.playing){g.stop();break}}}catch(h){c=!0,d=h}finally{try{!b&&f["return"]&&f["return"]()}finally{if(c)throw d}}}else{var i=!0,j=!1,k=void 0;try{for(var l,m=this._directionals[Symbol.iterator]();!(i=(l=m.next()).done);i=!0){var g=l.value;g.visible=!1,g.stop()}}catch(h){j=!0,k=h}finally{try{!i&&m["return"]&&m["return"]()}finally{if(j)throw k}}switch(a){case"up":this._up.visible=!0,this._up.play();break;case"down":this._down.visible=!0,this._down.play();break;case"left":this._left.visible=!0,this._left.play();break;case"right":this._right.visible=!0,this._right.play()}}}},{key:"visible",set:function(a){this._gfx.visible=a}},{key:"x",get:function(){return this._gfx.x},set:function(a){this._gfx.x=a}},{key:"y",get:function(){return this._gfx.y},set:function(a){this._gfx.y=a}},{key:"alpha",set:function(a){this._gfx.alpha=a}}]),a}();b.exports=f},{}],8:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a){switch(a){case"up":return"down";case"down":return"up";case"left":return"right";case"right":return"left"}}function f(a,b){return b!==e(a)}var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./config"),i=function(){function a(b,c,e,f,g,i,j){d(this,a),this._name=b,this._board=c,this._animation=g,this._turnAcceleration=j,this._turnAccelerationTimeLeft=0,this.x=e,this.y=f,this.width=h.wallSize,this.height=h.wallSize,this._normalSpeed=0,this._frightSpeed=0,this._frightened=!1,this._mode="",this._movementStrategy=i,this._reverseNeeded=!1,this.lastTileAIx=-1,this.lastTileAIy=-1,this.solid=!0,this._requestedDirectionAtStop=""}return g(a,[{key:"start",value:function(a,b,c,d,e,f){this._normalSpeed=h.topSpeed*a,this._frightSpeed=h.topSpeed*b,this._mode=c,this._requestedDirection=d,this._switchCurrentDirection(d),this._animation.start(e,f)}},{key:"step",value:function(a){if(this._animation.step(a),this._reverseNeeded){this._reverseNeeded=!1;var b=e(this._currentDirection);this._requestedDirection=b,this._switchCurrentDirection(b),this.lastTileAIx=-1,this.lastTileAIy=-1}var c=void 0;c=this._frightened?this._frightSpeed:this._normalSpeed,this._turnAccelerationTimeLeft>0&&(this._turnAccelerationTimeLeft-=a,c*=h.pacmanTurnSpeedIncrease);for(var d=0;a>d;d++)this._milliStep(c)}},{key:"signalFrightened",value:function(){this._frightened=!0,this._animation.startFrightened()}},{key:"removeFrightIfAny",value:function(){this._frightened=!1,this._animation.stopFrightened()}},{key:"ensureRequestedDirectionActive",value:function(){(""===this._requestedDirection||null===this._requestedDirection||void 0===this._requestedDirection)&&(this._requestedDirection=this._requestedDirectionAtStop)}},{key:"_milliStep",value:function(a){this._moveInCurrentDirection(a),this._runAI(),this._attemptTurnIfRequested()}},{key:"_moveInCurrentDirection",value:function(a){var b=this.x,c=this.y;switch(this._currentDirection){case"up":c-=a;break;case"down":c+=a;break;case"left":b-=a;break;case"right":b+=a}var d=this._board.tryMove(this.x,this.y,b,c,this.width,this.height);this.x=d.finalx,this.y=d.finaly,d.doStop&&(this.x=Math.floor(this.x),this.y=Math.floor(this.y),this._requestedDirectionAtStop=this._requestedDirection,this._requestedDirection="")}},{key:"_runAI",value:function(){this._movementStrategy.execute(this)}},{key:"_attemptTurnIfRequested",value:function(){if(this._requestedDirection!==this._currentDirection){var a=this.x,b=this.y,c=h.wallSize/2;switch(this._requestedDirection){case"up":b-=c;break;case"down":b+=c;break;case"left":a-=c;break;case"right":a+=c}var d=this._board.tryMove(this.x,this.y,a,b,this.width,this.height);d.success&&this._switchCurrentDirection(this._requestedDirection)}}},{key:"_switchCurrentDirection",value:function(a){var b=this._currentDirection;this._turnAcceleration&&f(b,a)&&(this._turnAccelerationTimeLeft=h.pacmanTurnSpeedLength),this._animation.changeDirection(a),this._currentDirection=a}},{key:"visible",set:function(a){this._animation.visible=a}},{key:"mode",get:function(){return this._mode},set:function(a){this._mode=a}},{key:"frightened",get:function(){return this._frightened}},{key:"x",get:function(){return this._animation.x},set:function(a){this._animation.x=a}},{key:"y",get:function(){return this._animation.y},set:function(a){this._animation.y=a}},{key:"currentDirection",get:function(){return this._currentDirection}},{key:"requestedDirection",set:function(a){this._requestedDirection=a}},{key:"reverseNeeded",set:function(a){this._reverseNeeded=a}},{key:"name",get:function(){return this._name}},{key:"alpha",set:function(a){this._animation.alpha=a}}]),a}();b.exports=i},{"./config":5}],9:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a),this._handlersMap=new Map}return e(a,[{key:"register",value:function(a,b){var c=void 0;0==this._handlersMap.has(a)?(c=[],this._handlersMap.set(a,c)):c=this._handlersMap.get(a),c.push(b)}},{key:"unregister",value:function(a,b){if(this._handlersMap.has(a)){var c=this._handlersMap.get(a),d=c.indexOf(b);-1!==d?c.splice(d,1):console.warn("Attempted to remove unregistered handler for event: "+a)}else console.warn("Attempted to remove handler for unregistered event: "+a)}},{key:"fire",value:function(a){var b=a.name,c=a.args;if(this._handlersMap.has(b)){var d=this._handlersMap.get(b),e=!0,f=!1,g=void 0;try{for(var h,i=d[Symbol.iterator]();!(e=(h=i.next()).done);e=!0){var j=h.value;null!==j&&void 0!==j&&j(c)}}catch(k){f=!0,g=k}finally{try{!e&&i["return"]&&i["return"]()}finally{if(f)throw g}}}}}]),a}(),g=new f;b.exports=g},{}],10:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=(a("./event-bus"),function(){function a(b,c){d(this,a),this._stage=b,this._input=c,this._gfx=new PIXI.Container,this._gfx.x=8,this._gfx.y=8,this._stage.addChild(this._gfx);var e={font:"16px Arial",fill:"#eeeeee"};this._text=new PIXI.Text("logic:",e),this._text.visible=!1,this._gfx.addChild(this._text),this._gfxText=new PIXI.Text("draw:",e),this._gfxText.x=96,this._gfxText.visible=!1,this._gfx.addChild(this._gfxText),this._elapsed=0,this._counter=0,this._drawCounter=0}return e(a,[{key:"start",value:function(){}},{key:"step",value:function(a){this._handleInput(),this._update(a)}},{key:"_handleInput",value:function(){this._input.isDownAndUnhandled("f")&&(this._text.visible=!this._text.visible,this._gfxText.visible=!this._gfxText.visible)}},{key:"_update",value:function(a){this._text.visible&&(this._elapsed+=a,this._counter+=1,this._elapsed>=1e3&&(this._text.text="logic: "+this._counter.toFixed(2),this._gfxText.text="draw: "+this._drawCounter.toFixed(2),this._elapsed-=1e3,this._counter=0,this._drawCounter=0))}},{key:"stepRender",value:function(){this._gfxText.visible&&(this._drawCounter+=1)}},{key:"stop",value:function(){this._stage.removeChild(this._gfx)}}]),a}());b.exports=f},{"./event-bus":9}],11:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./util"),g=(a("./config"),a("./event-bus"),a("./stats")),h=function(){function a(b){d(this,a),this._stage=b,this._gfx=new PIXI.Container,this._gfx.z=11,this._gfx.x=200,this._gfx.y=140,this._gfx.visible=!1,this._stage.addChild(this._gfx);var c=new PIXI.Graphics;c.beginFill(4473924,1),c.drawRect(0,0,400,310),this._gfx.addChild(c);var e={font:"36px Arial",fill:"#eeeeee"},f=new PIXI.Text("End of Game",e);f.x=96,f.y=28,this._gfx.addChild(f),this._playerRow=new i(this._gfx,"Player Avg Ratio"),this._playerRow.y=108,this._ghostsRow=new i(this._gfx,"Top Ghost Avg Ratio"),this._ghostsRow.y=150,this._developerRow=new i(this._gfx,"Developer Best"),this._developerRow.y=192}return e(a,[{key:"start",value:function(){var a=g.calculatePlayerAverageRatio();this._playerRow.awardIcon("pacman"),this._playerRow.notes=a.toFixed(2);var b=g.calculateTopGhostAverageRatio();this._ghostsRow.awardIcon(b.name),this._ghostsRow.notes=b.ratio.toFixed(2),this._developerRow.awardIcon("reptile"),this._developerRow.notes="6.11     2015-12-10",this._gfx.visible=!0}},{key:"step",value:function(a){}}]),a}();b.exports=h;var i=function(){function a(b,c){d(this,a),this._parentGfx=b,this._gfx=new PIXI.Container,this._gfx.x=40,this._parentGfx.addChild(this._gfx),this._iconContainer=new PIXI.Container,this._parentGfx.addChild(this._iconContainer);var e={font:"16px Arial",fill:"#eeeeee"},f=new PIXI.Text(c,e);f.x=48,f.y=6,this._gfx.addChild(f);var g={font:"12px Arial",fill:"#ffffff"};this._statsSprite=new PIXI.Text("",g),this._statsSprite.x=240,this._statsSprite.y=8,this._gfx.addChild(this._statsSprite)}return e(a,[{key:"awardIcon",value:function(a){var b=void 0;switch(a){case"pacman":b=f.createPacmanIcon(1);break;case"blinky":b=f.createGhostIcon("red",1);break;case"pinky":b=f.createGhostIcon("pink",1);break;case"inky":b=f.createGhostIcon("blue",1);break;case"clyde":b=f.createGhostIcon("orange",1);break;case"reptile":b=f.createGhostIcon("green",1)}this._gfx.addChild(b)}},{key:"notes",set:function(a){this._statsSprite.text=a}},{key:"y",set:function(a){this._gfx.y=a}}]),a}()},{"./config":5,"./event-bus":9,"./stats":29,"./util":30}],12:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a){for(var b,c,d=a.length;d>0;)c=Math.floor(Math.random()*d),d--,b=a[d],a[d]=a[c],a[c]=b;return a}var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./input"),h=a("./level"),i=a("./start-screen"),j=a("./level-ending"),k=a("./game-ending"),l=a("./sound"),m=a("./fps-counter"),n=a("./config"),o=a("./stats"),p=a("./event-bus");Window.meow=function(){p.fire({name:"event.level.end"})};var q=function(){function a(b,c){d(this,a),this._stage=b,this._renderer=c,this._input=new g,this._startScreen=new i(b,this._input),this._levelEnding=new j(b,c,this._input),this._gameEnding=new k(b),this._sound=new l(this._stage),this._fpsCounter=new m(this._stage,this._input),this._level=null,this._levelNumber=0,this._mazeOrder=[],this._lastStep=Date.now(),this._state="initialized"}return f(a,[{key:"start",value:function(){var a=this;document.body.appendChild(this._renderer.view),this._input.start(),o.start(),this._sound.start(),this._fpsCounter.start(),this._fillMazeOrder(),p.register("event.startscreen.end",function(){a._switchState("level-starting")}),p.register("event.level.end",function(){a._switchState("level-ending")}),p.register("event.level.ending.readyfornext",function(){a._switchState("level-starting")}),p.register("event.level.ending.lastlevel",function(){a._switchState("game-ending")}),this._switchState("startscreen-active")}},{key:"stop",value:function(){this._level.stop(),o.stop(),this._sound.stop(),this._fpsCounter.stop()}},{key:"draw",value:function(){this._renderer.render(this._stage),this._fpsCounter.stepRender()}},{key:"step",value:function(){var a=this._calculateElapsed();switch(this._state){case"initialized":break;case"startscreen-active":this._startScreen.step(a);break;case"level-starting":this._level.step(a),this._level.checkForEndLevelCondition()&&p.fire({name:"event.level.end"});break;case"level-ending":this._levelEnding.step(a);break;case"game-ending":this._gameEnding.step(a)}this._sound.step(a),this._fpsCounter.step(a),this._resortStageChildren()}},{key:"_fillMazeOrder",value:function(){for(var a=0;a<n.mazes.length;a++)this._mazeOrder.push(a);e(this._mazeOrder)}},{key:"_switchState",value:function(a){switch(this._state=a,a){case"initialized":break;case"startscreen-active":this._startScreen.start();break;case"level-starting":var b=this._level;null!==b&&void 0!==b?this._levelNumber=b.number+1:this._levelNumber=0,this._level=new h(this._levelNumber,this._input,this._stage,this._levelEnding,this._mazeOrder[this._levelNumber]),this._level.start();break;case"level-ending":this._levelEnding.start(this._levelNumber),this._level.stop();break;case"game-ending":this._gameEnding.start()}}},{key:"_calculateElapsed",value:function(){var a=Date.now()-this._lastStep;return a>1e3&&(a=1e3),this._lastStep=Date.now(),a}},{key:"_resortStageChildren",value:function(){this._stage.children.sort(function(a,b){return void 0===a.z||null===a.z?-1:void 0===b.z||null===b.z?1:b.z-a.z})}}]),a}();b.exports=q},{"./config":5,"./event-bus":9,"./fps-counter":10,"./game-ending":11,"./input":13,"./level":15,"./level-ending":14,"./sound":27,"./start-screen":28,"./stats":29}],13:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=(a("./event-bus"),function(){function a(){d(this,a),this._keyState=new Map,this._keyState.set("left","up"),this._keyState.set("up","up"),this._keyState.set("down","up"),this._keyState.set("enter","up"),this._keyState.set("other","up")}return f(a,[{key:"start",value:function(){var a=this;window.addEventListener("keydown",function(b){a._eventToState(b,"down")}),window.addEventListener("keyup",function(b){a._eventToState(b,"up")})}},{key:"isDown",value:function(a){return"down"===this._keyState.get(a)}},{key:"isDownAndUnhandled",value:function(a){return this.isDown(a)?(this._keyState.set(a,"handling"),!0):void 0}},{key:"isArrowKeyDown",value:function(){return"down"===this._keyState.get("up")||"down"===this._keyState.get("down")||"down"===this._keyState.get("left")||"down"===this._keyState.get("right")}},{key:"isAnyKeyDownAndUnhandled",value:function(){var a=!1,b=!0,c=!1,d=void 0;try{for(var f,g=this._keyState[Symbol.iterator]();!(b=(f=g.next()).done);b=!0){var h=e(f.value,2),i=h[0],j=h[1];"down"===j&&(this._keyState.set(i,"handling"),a=!0)}}catch(k){c=!0,d=k}finally{try{!b&&g["return"]&&g["return"]()}finally{if(c)throw d}}return a}},{key:"_eventToState",value:function(a,b){switch(a.keyCode){case 65:case 37:this._setState("left",b),a.preventDefault();break;case 87:case 38:this._setState("up",b);break;case 68:case 39:this._setState("right",b),a.preventDefault();break;case 83:case 40:this._setState("down",b),a.preventDefault();break;case 32:case 80:case 27:case 13:this._setState("enter",b),a.preventDefault();break;case 70:this._setState("f",b),a.preventDefault();break;case 82:case 18:case 224:case 17:case 91:case 93:case 84:case 78:case 219:case 221:break;case 191:case 9:case 16:a.preventDefault();break;default:this._setState("other",b)}}},{key:"_setState",value:function(a,b){"up"===b?this._keyState.set(a,"up"):"down"===b&&"handling"!==this._keyState.get(a)&&this._keyState.set(a,"down")}}]),a}());b.exports=g},{"./event-bus":9}],14:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./event-bus"),g=a("./config"),h=1e3,i=100,j=function(){function a(b,c,e){d(this,a),this._stage=b,this._renderer=c,this._input=e,this._blurTransitionTimeLeft=0,this._gfx=new PIXI.Container,this._gfx.z=10,this._gfx.x=220,this._gfx.y=96,this._gfx.visible=!1,this._stage.addChild(this._gfx);var f=new PIXI.Graphics;f.beginFill(3355443,.95),f.drawRect(0,0,390,320),this._gfx.addChild(f);var g={font:"36px Arial",fill:"#eeeeee",align:"center"};this._title=new PIXI.Text("",g),this._title.x=36,this._title.y=44,this._gfx.addChild(this._title);var h={font:"16px Arial",fill:"#e0e0e0",align:"center"};this._footer=new PIXI.Text("",h),this._footer.x=114,this._footer.y=275,this._gfx.addChild(this._footer),this._scoreboard=null}return e(a,[{key:"start",value:function(a){this._levelNumber=a,this._title.text="Level "+(a+1)+" Final Score",this._updateFooter(a);var b=new PIXI.RenderTexture(this._renderer,this._renderer.width,this._renderer.height);b.render(this._stage),this._snapshotSprite=new PIXI.Sprite(b),this._stage.addChild(this._snapshotSprite),this._blurFilter=new PIXI.filters.BlurFilter,this._blurFilter.blur=0,this._snapshotSprite.filters=[this._blurFilter],this._blurTransitionTimeLeft=h;var c=new PIXI.RenderTexture(this._renderer,this._renderer.width,this._renderer.height);c.render(this._scoreboard.gfx),this._scoreboardSnapshot=new PIXI.Sprite(c),this._scoreboardSnapshot.x=90,this._scoreboardSnapshot.y=100,this._gfx.addChild(this._scoreboardSnapshot)}},{key:"step",value:function(a){this._stepGreyTransition(a),this._stepStatsWindow()}},{key:"_stepGreyTransition",value:function(a){this._blurTransitionTimeLeft>0&&(this._blurTransitionTimeLeft-=a,this._blurTransitionTimeLeft<=0?(this._blurTransitionTimeLeft=0,this._gfx.visible=!0):this._blurFilter.blur=i-this._blurTransitionTimeLeft/h*i)}},{key:"_stepStatsWindow",value:function(a){this._gfx.visible&&this._input.isAnyKeyDownAndUnhandled()&&this._stop()}},{key:"_stop",value:function(){this._gfx.visible=!1,this._snapshotSprite.filters=null;var a=this._stage.getChildIndex(this._snapshotSprite);this._stage.removeChildAt(a);var b=this._gfx.getChildIndex(this._scoreboardSnapshot);this._gfx.removeChildAt(b),this._isFinalLevel()?f.fire({name:"event.level.ending.lastlevel"}):f.fire({name:"event.level.ending.readyfornext"})}},{key:"_isFinalLevel",value:function(){return this._levelNumber===g.lastLevelIndex()}},{key:"_updateFooter",value:function(a){var b=void 0;if(this._isFinalLevel())b="";else{var c=g.levelSpecifications.length-(a+1);b=1===c?"The final level remains...":g.levelSpecifications.length-(a+1)+" more levels remain..."}this._footer.text=b}},{key:"scoreboard",set:function(a){this._scoreboard=a}}]),a}();b.exports=j},{"./config":5,"./event-bus":9}],15:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./board"),g=a("./config"),h=a("./characters"),i=a("./long-tasks"),j=a("./pause"),k=a("./scoreboard"),l=a("./particle-emitter"),m=a("./character-particle-emitter"),n=a("./event-bus"),o=a("./screen-shake"),p=function(){function a(b,c,e,g,n){d(this,a),this.number=b,this._input=c,this._stage=e,this._gfx=new PIXI.Container,this._gfx.z=1,this._gfx.x=32,this._gfx.y=32,this._stage.addChild(this._gfx),this._board=new f(this._gfx,n),this._longTasksManager=new i.Manager,this._characters=new h(this._board,this._gfx,this._longTasksManager),this._currentGhostSubModeIndex=0,this._ghostSubModeElapsed=0,this._frightTimeLeft=null,this._lvlSpec=null,this._pause=new j(e,c),this._scoreboard=new k(e),g.scoreboard=this._scoreboard,this._particleEmitter=new l(this._gfx),this._characterParticleEmitter=new m(this._gfx)}return e(a,[{key:"start",value:function(){this._lvlSpec=g.levelSpecifications[this.number],this._characters.start(this._lvlSpec),this._pause.start(),this._scoreboard.start(),this._particleEmitter.start(),this._characterParticleEmitter.start(),o.start(this._gfx),n.fire({name:"event.level.start",args:{levelNumber:this.number}})}},{key:"stop",value:function(){this._characters.stop(),this._pause.stop(),this._scoreboard.stop(),this._particleEmitter.stop(),this._characterParticleEmitter.stop(),o.stop();var a=this._stage.getChildIndex(this._gfx);this._stage.removeChildAt(a),this._gfx.destroy(!0)}},{key:"step",value:function(a){this._pause.active||(this._handleLongTasks(a),this._handleSubMode(a),this._handleCollisionsAndSteps(a),o.step(a),this._particleEmitter.step(a),this._characterParticleEmitter.step(a)),this._stepPaused(a)}},{key:"checkForEndLevelCondition",value:function(){return 0==this._board.dotsLeft()}},{key:"_stepPaused",value:function(a){this._pause.step(a)}},{key:"_handleLongTasks",value:function(a){this._longTasksManager.step(a)}},{key:"_handleSubMode",value:function(a){if(null!==this._frightTimeLeft)return void this._handleFrightLeft(a);this._ghostSubModeElapsed+=a;var b=this._lvlSpec.ghostMode[this._currentGhostSubModeIndex].time;if(this._ghostSubModeElapsed>=b){this._currentGhostSubModeIndex+=1,this._ghostSubModeElapsed=0;var c=this._lvlSpec.ghostMode[this._currentGhostSubModeIndex].mode;this._characters.switchMode(c)}}},{key:"_handleFrightLeft",value:function(a){this._frightTimeLeft-=a,this._frightTimeLeft<=0&&(this._characters.removeRemainingFright(),this._frightTimeLeft=null)}},{key:"_handleCollisionsAndSteps",value:function(a){var b=this._characters.checkCollisions(),c=this._determineRequestedDirection();b.collision?this._characters.stepPacman(0,c):this._characters.stepPacman(a,c),this._characters.stepGhosts(a),b.energizer&&(this._characters.signalFright(),this._frightTimeLeft=this._lvlSpec.frightTime,n.fire({name:"event.action.energizer"})),b.dot&&n.fire({name:"event.action.eatdot",args:{x:b.x,y:b.y,direction:this._determineCurrentDirection()}})}},{key:"_determineRequestedDirection",value:function(){return this._input.isDown("up")?"up":this._input.isDown("down")?"down":this._input.isDown("left")?"left":this._input.isDown("right")?"right":null}},{key:"_determineCurrentDirection",value:function(){return this._characters.determineCurrentDirection()}}]),a}();b.exports=p},{"./board":1,"./character-particle-emitter":3,"./characters":4,"./config":5,"./event-bus":9,"./long-tasks":17,"./particle-emitter":20,"./pause":21,"./scoreboard":24,"./screen-shake":25}],16:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=8,g=function(){function a(){d(this,a),this._container=document.getElementById("loading"),this._message=document.getElementById("loadingMessage"),this._error=document.getElementById("loadingError"),this._progress=document.getElementById("loadingBar"),void 0!==this._progress&&this._progress.setAttribute("max",f),this._loadedCount=0,this._success=!0}return e(a,[{key:"signalLoaded",value:function(a,b){if(void 0!==this._container)if(this._container.style.visibility="visible",this._loadedCount+=1,this._progress.setAttribute("value",this._loadedCount),a)this._message.textContent=b;else{this._success=!1;var c=document.createElement("div");c.textContent=b,this._error.appendChild(c),console.error(b)}}},{key:"signalPreloadComplete",value:function(){void 0!==this._container&&this._success&&(this._container.outerHTML="",delete this._container)}}]),a}();b.exports=g},{}],17:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b,c){d(this,a),this._time=b,this._cb=c,this._totalElapsed=0,this.completed=!1}return e(a,[{key:"step",value:function(a){this._totalElapsed+=a,this._totalElapsed>=this._time&&(this._cb(),this.completed=!0)}}]),a}(),g=function(){function a(b,c){d(this,a),this._time=b,this._cb=c,this._totalElapsed=0,this.completed=!1}return e(a,[{key:"step",value:function(a){this._totalElapsed+=a,this._totalElapsed>=this._time&&(this._cb()===!1?this.completed=!0:this._totalElapsed=0)}}]),a}(),h=function(){function a(){d(this,a),this._tasks=[]}return e(a,[{key:"addTask",value:function(a){this._tasks.push(a)}},{key:"step",value:function(a){var b=!0,c=!1,d=void 0;try{for(var e,f=this._tasks[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value;g.step(a)}}catch(h){c=!0,d=h}finally{try{!b&&f["return"]&&f["return"]()}finally{if(c)throw d}}for(var i=this._tasks.length-1;i>=0;i--)this._tasks[i].completed&&this._tasks.splice(i,1)}}]),a}();c.TimeoutTask=f,c.IntervalTask=g,c.Manager=h},{}],18:[function(a,b,c){"use strict";a("./safari-audio-bandaid").check(),a("./preload").start(function(){function b(){setTimeout(b,16.66),g.step()}function c(){requestAnimationFrame(c),g.draw()}var d=a("./game"),e=new PIXI.Container,f=PIXI.autoDetectRenderer(800,600,{backgroundColor:3355443}),g=new d(e,f);g.start(),b(),c()})},{"./game":12,"./preload":22,"./safari-audio-bandaid":23}],19:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b,c){var d=i.convertToTileSpace(a.x),e=i.convertToTileSpace(a.y);if(d!==a.lastTileAIx||e!==a.lastTileAIy){a.lastTileAIx=d,a.lastTileAIy=e;var f=g(d,e,a.currentDirection,b);1===f.length?a.requestedDirection=f[0]:f.length>=2&&c(f)}}function f(a,b,c,d){var e=d.map(function(d){var e=0,f=0;switch(d){case"up":f=-1;break;case"down":f=1;break;case"left":e=-1;break;case"right":e=1}var g=i.convertToTileSpace(a.x),h=i.convertToTileSpace(a.y),j=i.qs(g+e-b,h+f-c);return{direction:d,distance:j}});e.sort(function(a,b){return a.distance-b.distance}),a.requestedDirection=e[0].direction}function g(a,b,c,d){var e=[];return"up"!==c&&d.isWallOpen(a,b+1)&&e.push("down"),"down"!==c&&d.isWallOpen(a,b-1)&&e.push("up"),"left"!==c&&d.isWallOpen(a+1,b)&&e.push("right"),"right"!==c&&d.isWallOpen(a-1,b)&&e.push("left"),e}var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a("./util"),j=function(){function a(b,c,e){var f=arguments.length<=3||void 0===arguments[3]?null:arguments[3],g=arguments.length<=4||void 0===arguments[4]?null:arguments[4],h=arguments.length<=5||void 0===arguments[5]?null:arguments[5],i=arguments.length<=6||void 0===arguments[6]?null:arguments[6];d(this,a),this._board=b,this._method=this[c],this._frightMethod=this[e],this._scatterx=f,this._scattery=g,this._pacman=h,this._blinky=i}return h(a,[{key:"execute",value:function(a){a.frightened?this._frightMethod(a):"chase"===a.mode?this._method(a):"scatter"===a.mode&&this.scatter(a)}},{key:"doNothing",value:function(a){}},{key:"random",value:function(a){e(a,this._board,function(b){var c=i.getRandomIntInclusive(0,b.length-1);a.requestedDirection=b[c]})}},{key:"scatter",value:function(a){var b=this;e(a,this._board,function(c){f(a,b._scatterx,b._scattery,c)})}},{key:"blinky",value:function(a){var b=this;e(a,this._board,function(c){var d=i.convertToTileSpace(b._pacman.x),e=i.convertToTileSpace(b._pacman.y);f(a,d,e,c)})}},{key:"pinky",value:function(a){var b=this;e(a,this._board,function(c){var d=i.convertToTileSpace(b._pacman.x),e=i.convertToTileSpace(b._pacman.y);switch(b._pacman.currentDirection){case"up":e-=4;break;case"down":e+=4;break;case"left":d-=4;break;case"right":d+=4}f(a,d,e,c)})}},{key:"inky",value:function(a){var b=this;e(a,this._board,function(c){var d=i.convertToTileSpace(b._pacman.x),e=i.convertToTileSpace(b._pacman.y);switch(b._pacman.currentDirection){case"up":e-=2;break;case"down":e+=2;break;case"left":d-=2;break;case"right":d+=2}var g=i.convertToTileSpace(b._blinky.x),h=i.convertToTileSpace(b._blinky.y),j=d-g,k=e-h,l=d+j,m=e+k;f(a,l,m,c)})}},{key:"clyde",value:function(a){var b=this;e(a,this._board,function(c){var d=i.convertToTileSpace(b._pacman.x),e=i.convertToTileSpace(b._pacman.y),g=i.convertToTileSpace(a.x),h=i.convertToTileSpace(a.y),j=i.qs(d-g,e-h);j>=64?f(a,d,e,c):f(a,1,30,c)})}}]),a}();b.exports=j},{"./util":30}],20:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a){var b=-1,c=1,d=-1,e=1,f=12,g=0,h=0;switch(a){case"up":d-=1,e-=1,h=-f;break;case"down":d+=1,e+=1,h=f;break;case"left":b-=1,c-=1,g=-f;break;case"right":b+=1,c+=1,g=f}var i=Math.random()*(c-b)+b,j=Math.random()*(e-d)+d;return{xenergy:i,yenergy:j,xoffset:g,yoffset:h}}function f(a,b,c,d,e){var f=Math.random()*(b-a)+a,g=Math.random()*(d-c)+c,h=Math.random()*e;return{x:f,y:g,ttl:h}}var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./event-bus"),i=function(){function a(b,c,e,f,g,h,i){d(this,a),this._parentGfx=b,this._gfx=new PIXI.Sprite(c),b.addChild(this._gfx),this._gfx.x=e,this._gfx.y=f,this._ttl=g,this._xenergy=h,this._yenergy=i}return g(a,[{key:"step",value:function(a){return this._ttl-=a,this._ttl<=0?(this._remove(),!1):(this._update(),!0)}},{key:"_remove",value:function(){this._parentGfx.removeChild(this._gfx);
}},{key:"_update",value:function(){this._gfx.x+=this._xenergy,this._gfx.y+=this._yenergy}}]),a}(),j=function(){function a(b){d(this,a),this._parentGfx=b,this._gfx=new PIXI.ParticleContainer,b.addChild(this._gfx);var c=new PIXI.Graphics;c.beginFill(16777215,1),c.drawRect(0,0,2,2),c.endFill(),this._sharedTexture=c.generateTexture(),this._particles=[]}return g(a,[{key:"start",value:function(){var a=this;this._eatdotHandler=function(b){var c=e(b.direction),d=c.xenergy,f=c.yenergy,g=c.xoffset,h=c.yoffset;a._emitDotCrumbs(b.x+g,b.y+h,d,f)},h.register("event.action.eatdot",this._eatdotHandler)}},{key:"step",value:function(a){this._particles=this._particles.filter(function(b){return b.step(a)})}},{key:"stop",value:function(){h.unregister("event.action.eatdot",this._eatdotHandler),this._parentGfx.removeChild(this._gfx)}},{key:"_emitDotCrumbs",value:function(a,b,c,d){for(var e=0;8>e;e++){var g=f(a-4,a+4,b-4,b+4,500),h=g.x,j=g.y,k=g.ttl;this._particles.push(new i(this._gfx,this._sharedTexture,h,j,k,c,d))}}}]),a}();b.exports=j},{"./event-bus":9}],21:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./event-bus"),g=500,h=.75,i=function(){function a(b,c){d(this,a),this._stage=b,this._input=c,this.active=!1;var e={font:"36px Arial",fill:"#eeeeee",align:"center",wordWrap:!0,wordWrapWidth:250};this._instructions=new PIXI.Text("Paused\n\nPress any key to continue",e),this._instructions.x=520,this._instructions.y=100,this._instructions.visible=!1,this.filter=new PIXI.filters.SepiaFilter,this.filter.sepia=h,this._transitionTimeLeft=0}return e(a,[{key:"start",value:function(){this._stage.addChild(this._instructions),this.active=!1,this._flip(),this.step(1e3,!0)}},{key:"stop",value:function(){var a=this._stage.getChildIndex(this._instructions);this._stage.removeChildAt(a),this._instructions.destroy()}},{key:"step",value:function(a){this._handleInput(),this._stepTransition(a)}},{key:"_handleInput",value:function(){this.active?this._input.isArrowKeyDown()?this._flip():this._input.isAnyKeyDownAndUnhandled()&&this._flip():this._input.isDownAndUnhandled("enter")&&this._flip()}},{key:"_flip",value:function(){this.active=!this.active,this._beginTransition(),this.active?f.fire({name:"event.pause.begin"}):f.fire({name:"event.pause.end"})}},{key:"_beginTransition",value:function(){this._stage.filters=[this.filter],0!==this._transitionTimeLeft?this._transitionTimeLeft=g-this._transitionTimeLeft:this._transitionTimeLeft=g,this._instructions.visible=!1}},{key:"_stepTransition",value:function(a){if(this._transitionTimeLeft>0){var b=this._transitionTimeLeft/g*h;this.active?this.filter.sepia=h-b:this.filter.sepia=b,this._transitionTimeLeft-=a,this._transitionTimeLeft<=0&&(this._transitionTimeLeft=0,this._completeTransition())}}},{key:"_completeTransition",value:function(){this.active?(this.filter.sepia=.75,this._instructions.visible=!0):(this.filter.sepia=0,this._stage.filters=null)}}]),a}();b.exports=i},{"./event-bus":9}],22:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./loading-screen"),g=a("./sound-preloader"),h=function(){function a(){d(this,a),this._sfxLoaded=!1,this._gfxLoaded=!1,this._afterFinished=null,this._success=!0,this._loadingScreen=new f}return e(a,[{key:"start",value:function(a){var b=this;this._afterFinished=a,PIXI.loader.on("error",function(){b._loadingScreen.signalLoaded(!1,"Could not load sprites"),b._success=!1}),PIXI.loader.add("assets/mazing-v1.json").load(function(){b._gfxLoaded=!0,b._loadingScreen.signalLoaded("Sprites loaded"),b._handleIfFinished()}),g.load(this._loadingScreen,["assets/punch-v1.m4a","assets/wham1-v1.m4a","assets/wham2-v1.m4a","assets/wham3-v1.m4a","assets/energizer-v1.m4a","assets/crackles-v1.m4a","assets/cool-journey-v1.m4a"],function(a){b._sfxLoaded=!0,b._handleIfFinished(a)})}},{key:"_handleIfFinished",value:function(a){a===!1&&(this._success=!1),this._success&&this._gfxLoaded&&this._sfxLoaded===!0&&this._afterFinished()}}]),a}(),i=new h;b.exports=i},{"./loading-screen":16,"./sound-preloader":26}],23:[function(a,b,c){"use strict";function d(a){console.error("Cannot set Safari reload key - sound might not work until reloaded manually: "+a)}var e="safari-reload-193289123",f=500;c.check=function(){var a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);a?navigator.cookieEnabled===!1?d(1):void 0!==sessionStorage?"y"!==sessionStorage.getItem(e)?(sessionStorage.setItem(e,"y"),"y"===sessionStorage.getItem(e)?(console.log("Safari and first load - waiting for refresh to occur."),setTimeout(function(){document.location.reload(!1)},f)):d(2)):console.log("Reload key already set."):d(3):console.log("Not Safari, skipping reload check.")}},{}],24:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a){return j+(a+1)*k}function f(a,b){var c=void 0,d=void 0;return c=0===a.kills&&0===a.deaths?-1:a.ratio,d=0===b.kills&&0===b.deaths?-1:b.ratio,c!==d?d-c:a.kills!==b.kills?b.kills-a.kills:a.deaths-b.deaths}var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./event-bus"),i=a("./util"),j=10,k=25,l=35,m=90,n=145,o=function(){function a(b){d(this,a),this._stage=b,this._gfx=new PIXI.Container,this._gfx.x=540,this._gfx.y=390,b.addChild(this._gfx),this._textStyle={font:"14px Arial",fill:"#eeeeee",align:"center"},this._headerRatio=new PIXI.Text("Ratio",this._textStyle),this._headerRatio.x=l,this._headerRatio.y=j,this._gfx.addChild(this._headerRatio),this._headerKills=new PIXI.Text("Eater",this._textStyle),this._headerKills.x=m,this._headerKills.y=j,this._gfx.addChild(this._headerKills),this._headerDeaths=new PIXI.Text("Eaten",this._textStyle),this._headerDeaths.x=n,this._headerDeaths.y=j,this._gfx.addChild(this._headerDeaths),this._rows=[],this._rows.push(this._createRow(0,"pacman",i.createPacmanIcon(.5))),this._rows.push(this._createRow(1,"blinky",i.createGhostIcon("red",.5))),this._rows.push(this._createRow(2,"pinky",i.createGhostIcon("pink",.5))),this._rows.push(this._createRow(3,"inky",i.createGhostIcon("blue",.5))),this._rows.push(this._createRow(4,"clyde",i.createGhostIcon("orange",.5)))}return g(a,[{key:"start",value:function(){var a=this;this._pacmanDeathListener=function(b){a._handlePacmanDeath(b.ghostName)},h.register("event.action.death.pacman",this._pacmanDeathListener),this._ghostDeathListener=function(b){a._handleGhostDeath(b.ghostName)},h.register("event.action.death.ghost",this._ghostDeathListener)}},{key:"stop",value:function(){h.unregister("event.action.death.pacman",this._pacmanDeathListener),h.unregister("event.action.death.ghost",this._ghostDeathListener);var a=this._stage.getChildIndex(this._gfx);this._stage.removeChildAt(a),this._gfx.destroy()}},{key:"_createRow",value:function(a,b,c){var d=new p(b,this._gfx,this._textStyle,c);return d.y=e(a),d}},{key:"_handlePacmanDeath",value:function(a){var b=!0,c=!1,d=void 0;try{for(var e,f=this._rows[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value;"pacman"===g.name?g.incrementDeaths():g.name===a&&g.incrementKills()}}catch(h){c=!0,d=h}finally{try{!b&&f["return"]&&f["return"]()}finally{if(c)throw d}}this._resortRows()}},{key:"_handleGhostDeath",value:function(a){var b=!0,c=!1,d=void 0;try{for(var e,f=this._rows[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value;"pacman"===g.name?g.incrementKills():g.name===a&&g.incrementDeaths()}}catch(h){c=!0,d=h}finally{try{!b&&f["return"]&&f["return"]()}finally{if(c)throw d}}this._resortRows()}},{key:"_resortRows",value:function(){this._rows.sort(f);for(var a=0;a<this._rows.length;a++){var b=this._rows[a];b.y=e(a)}}},{key:"gfx",get:function(){return this._gfx}}]),a}();b.exports=o;var p=function(){function a(b,c,e,f){d(this,a),this._name=b,this._parentGfx=c,this._gfx=new PIXI.Container,this._parentGfx.addChild(this._gfx),this._ratioGfx=new PIXI.Text("",e),this._ratioGfx.x=l,this._gfx.addChild(this._ratioGfx),this._kills=0,this._killsGfx=new PIXI.Text("",e),this._killsGfx.x=m,this._gfx.addChild(this._killsGfx),this._deaths=0,this._deathsGfx=new PIXI.Text("",e),this._deathsGfx.x=n,this._gfx.addChild(this._deathsGfx),this._gfx.addChild(f)}return g(a,[{key:"incrementKills",value:function(){this._kills+=1,this._killsGfx.text=this._kills,this._updateRatioGfx()}},{key:"incrementDeaths",value:function(){this._deaths+=1,this._deathsGfx.text=this._deaths,this._updateRatioGfx()}},{key:"_updateRatioGfx",value:function(){var a=this.ratio;a===Number.MAX_SAFE_INTEGER?this._ratioGfx.text="*":this._ratioGfx.text=a.toFixed(2)}},{key:"name",get:function(){return this._name}},{key:"ratio",get:function(){return 0!==this._deaths?this._kills/this._deaths:Number.MAX_SAFE_INTEGER}},{key:"kills",get:function(){return this._kills}},{key:"deaths",get:function(){return this._deaths}},{key:"y",set:function(a){this._gfx.y=a}}]),a}()},{"./event-bus":9,"./util":30}],25:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b,c,d){var e=a*b/2,f=g.getRandomIntInclusive(0-e,e),h=g.getRandomIntInclusive(0-e,e),i=c+f,j=d+h;return{x:i,y:j}}var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./util"),h=a("./event-bus"),i=200,j=40,k=function(){function a(){var b=this;d(this,a),this._shakeTimeLeft=0,this._intensity=0,this._gfx=null,this._originalx=0,this._originaly=0,this._onShakeStart=function(){b._handleShakingStart()}}return f(a,[{key:"start",value:function(a){this._gfx=a,this._originalx=this._gfx.x,this._originaly=this._gfx.y,h.register("event.screenshake.start",this._onShakeStart)}},{key:"step",value:function(a){if(this._shakeTimeLeft>0)if(this._shakeTimeLeft-=a,this._shakeTimeLeft<=0)this._shakeTimeLeft=0,this._intensity=0,this._resetPosition();else{var b=1-this._shakeTimeLeft/i,c=e(b,this._intensity,this._originalx,this._originaly),d=c.x,f=c.y;this._gfx.x=d,this._gfx.y=f}}},{key:"stop",value:function(){this._resetPosition(),h.unregister("event.screenshake.start",this._onShakeStart)}},{key:"_handleShakingStart",value:function(){this._shakeTimeLeft=i,this._intensity=j}},{key:"_resetPosition",value:function(){this._gfx.x=this._originalx,this._gfx.y=this._originaly}}]),a}(),l=new k;b.exports=l},{"./event-bus":9,"./util":30}],26:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a),this._cache=new Map,this._totalcount=0,this._loadedcount=0,this._afterFinished=null,this._success=!0}return e(a,[{key:"load",value:function(a,b,c){var d=this;this._loadingScreen=a,this._afterFinished=c,this._totalcount=b.length;var e=!0,f=!1,g=void 0;try{for(var h,i=function(){var a=h.value,b=new Howl({urls:[a],onload:function(){d._onloadEach(!0,a)},onloaderror:function(){d._onloadEach(!1,a)}});d._cache.set(a,b)},j=b[Symbol.iterator]();!(e=(h=j.next()).done);e=!0)i()}catch(k){f=!0,g=k}finally{try{!e&&j["return"]&&j["return"]()}finally{if(f)throw g}}}},{key:"get",value:function(a){return this._cache.get(a)}},{key:"_onloadEach",value:function(a,b){this._loadedcount+=1,a?this._loadingScreen.signalLoaded(!0,"Loaded sound ("+this._loadedcount+"/"+this._totalcount+")"):(this._loadingScreen.signalLoaded(!1,"Unable to load sound: "+b),this._success=!1),this._loadedcount>=this._totalcount&&(this._loadingScreen.signalPreloadComplete(),this._afterFinished(this._success))}}]),a}(),g=new f;b.exports=g},{}],27:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./util"),g=a("./event-bus"),h=a("./sound-preloader"),i=.7,j="183461283-sound-mute",k=200,l=function(){function a(b){var c=this;d(this,a),this.parentGfx=b,this._gfx=new PIXI.Container,this._gfx.x=750,this._gfx.y=550,this.parentGfx.addChild(this._gfx);var e=PIXI.Texture.fromFrame("sound-on.png");this._soundOnIcon=new PIXI.Sprite(e),this._soundOnIcon.alpha=i,this._soundOnIcon.interactive=!0,this._soundOnIcon.on("mouseover",function(){c._soundOnIcon.alpha=1}),this._soundOnIcon.on("mouseout",function(){c._soundOnIcon.alpha=i}),this._soundOnIcon.on("mousedown",function(){c._soundOnIcon.visible=!1,c._soundOffIcon.visible=!0,Howler.mute(),sessionStorage.setItem(j,"on")}),this._soundOnIcon.visible=!1,this._gfx.addChild(this._soundOnIcon);var f=PIXI.Texture.fromFrame("sound-off.png");this._soundOffIcon=new PIXI.Sprite(f),this._soundOffIcon.interactive=!0,this._soundOffIcon.on("mouseover",function(){c._soundOffIcon.alpha=1}),this._soundOffIcon.on("mouseout",function(){c._soundOffIcon.alpha=i}),this._soundOffIcon.on("mousedown",function(){c._soundOffIcon.visible=!1,c._soundOnIcon.visible=!0,Howler.unmute(),sessionStorage.setItem(j,"off")}),this._soundOffIcon.alpha=i,this._soundOffIcon.visible=!1,this._gfx.addChild(this._soundOffIcon),this._levelEnd=new Howl({urls:["assets/atari-st-beat-11-v1.m4a"],volume:.35,onload:function(){console.log("Loaded sound (level end)")},onloaderror:function(){console.error("Unable to load sound (level end")}});var g=new Howl({urls:["assets/happy-energy-v1.m4a"],onload:function(){console.log("Loaded sound (happy-energy)")},onloaderror:function(){console.error("Unable to load sound (happy-energy")}});this._punch=h.get("assets/punch-v1.m4a"),this._punch.volume(.4);var k=h.get("assets/wham1-v1.m4a"),l=h.get("assets/wham2-v1.m4a"),m=h.get("assets/wham3-v1.m4a");this._whams=[k,l,m];var n=!0,o=!1,p=void 0;try{for(var q,r=this._whams[Symbol.iterator]();!(n=(q=r.next()).done);n=!0){var s=q.value;s.volume(.2)}}catch(t){o=!0,p=t}finally{try{!n&&r["return"]&&r["return"]()}finally{if(o)throw p}}this._energizer=h.get("assets/energizer-v1.m4a"),this._energizer.volume(.5);var u=h.get("assets/cool-journey-v1.m4a");this._levelBackgrounds=[u,g];var v=!0,w=!1,x=void 0;try{for(var y,z=this._levelBackgrounds[Symbol.iterator]();!(v=(y=z.next()).done);v=!0){var A=y.value;A.volume(.9),A.loop(!0)}}catch(t){w=!0,x=t}finally{try{!v&&z["return"]&&z["return"]()}finally{if(w)throw x}}this._currentBackground=0,this._crackles=h.get("assets/crackles-v1.m4a"),this._crackles.volume(.3),this._crackles.loop(!0),this._cracklesTimeLeft=0,Howler.volume(.9)}return e(a,[{key:"step",value:function(a){this._cracklesTimeLeft>0&&(this._cracklesTimeLeft-=a,this._cracklesTimeLeft<=0&&(this._cracklesTimeLeft=0,this._crackles.pause()))}},{key:"start",value:function(){var a=this;this._pauseBackgroundMusic=function(){a._levelBackgrounds[a._currentBackground].pause()},g.register("event.pause.begin",this._pauseBackgroundMusic),this._playBackgroundMusic=function(){a._levelBackgrounds[a._currentBackground].play()},g.register("event.pause.end",this._playBackgroundMusic),this._playLevelEndMusic=function(){a._stopAllMusic(),a._levelEnd.play()},g.register("event.level.end",this._playLevelEndMusic),this._stopLevelEndMusic=function(){a._levelEnd.stop(),a._currentBackground+=1,a._currentBackground>=a._levelBackgrounds.length&&(a._currentBackground=0)},g.register("event.level.ending.readyfornext",this._stopLevelEndMusic),this._playWham=function(){var b=f.getRandomIntInclusive(0,a._whams.length-1);a._whams[b].play()},g.register("event.action.death.pacman",this._playWham),this._playPunch=function(){a._punch.play()},g.register("event.action.death.ghost",this._playPunch),this._playEnergizer=function(){a._energizer.play()},g.register("event.action.energizer",this._playEnergizer),this._ensureCrackles=function(){a._cracklesTimeLeft>0?a._cracklesTimeLeft=k:(a._cracklesTimeLeft=k,a._crackles.play())},g.register("event.action.eatdot",this._ensureCrackles);var b=sessionStorage.getItem(j);"on"===b?(this._soundOffIcon.visible=!0,Howler.mute()):(this._soundOnIcon.visible=!0,Howler.unmute())}},{key:"stop",value:function(){g.unregister("event.action.death.ghost",this._playWham),g.unregister("event.action.death.ghost",this._playPunch),g.unregister("event.action.energizer",this._playEnergizer)}},{key:"_stopAllMusic",value:function(){var a=!0,b=!1,c=void 0;try{for(var d,e=this._levelBackgrounds[Symbol.iterator]();!(a=(d=e.next()).done);a=!0){var f=d.value;f.stop()}}catch(g){b=!0,c=g}finally{try{!a&&e["return"]&&e["return"]()}finally{if(b)throw c}}this._levelEnd.stop()}}]),a}();b.exports=l},{"./event-bus":9,"./sound-preloader":26,"./util":30}],28:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){var c=1-a/b;return.8>c?c:.8-(c-.8)/.2}var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./event-bus"),h=2500,i=function(){function a(b,c){d(this,a),this._stage=b,this._input=c,this._pixelateTransitionTimeLeft=0,this._logo=new PIXI.Container,b.addChild(this._logo);var e={font:"36px Arial",fill:"#eeeeee",align:"center"},f=new PIXI.Text("Based on a true story",e);f.anchor.set(.5,.5),f.x=400,f.y=300,this._logo.addChild(f)}return f(a,[{key:"start",value:function(){this._pixelateTransitionTimeLeft=h}},{key:"step",value:function(a){var b=this._pixelateTransitionTimeLeft/h;if(this._input.isAnyKeyDownAndUnhandled()&&b>.2&&(this._pixelateTransitionTimeLeft=.2*h),this._pixelateTransitionTimeLeft-=a,this._pixelateTransitionTimeLeft<=0){var c=this._stage.getChildIndex(this._logo);this._stage.removeChildAt(c),g.fire({name:"event.startscreen.end"})}else this._logo.alpha=e(this._pixelateTransitionTimeLeft,h)}}]),a}();b.exports=i},{"./event-bus":9}],29:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./config"),g=a("./event-bus"),h=function(){function a(b){d(this,a),this._name=b,this._rounds=[];for(var c=0;c<f.levelSpecifications.length;c++){var e={kills:0,deaths:0};this._rounds.push(e)}}return e(a,[{key:"incrementKills",value:function(a){this._rounds[a].kills+=1}},{key:"incrementDeaths",value:function(a){this._rounds[a].deaths+=1}},{key:"calculateAverageRatio",value:function(){var a=0,b=!0,c=!1,d=void 0;try{for(var e,f=this._rounds[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value,h=g.kills,i=void 0;i=0===g.deaths?1:g.deaths,a+=h/i}}catch(j){c=!0,d=j}finally{try{!b&&f["return"]&&f["return"]()}finally{if(c)throw d}}return a/this._rounds.length}},{key:"name",get:function(){return this._name}}]),a}(),i=function(){function a(){d(this,a),this.entityStats=new Map,this.entityStats.set("pacman",new h("pacman")),this.entityStats.set("blinky",new h("blinky")),this.entityStats.set("pinky",new h("pinky")),this.entityStats.set("inky",new h("inky")),this.entityStats.set("clyde",new h("clyde")),this._currentRound=0}return e(a,[{key:"start",value:function(){var a=this;this._levelChangeListener=function(b){a._currentRound=b.levelNumber},g.register("event.level.start",this._levelChangeListener),this._pacmanDeathListener=function(b){a._handlePacmanDeath(b.ghostName)},g.register("event.action.death.pacman",this._pacmanDeathListener),this._ghostDeathListener=function(b){a._handleGhostDeath(b.ghostName)},g.register("event.action.death.ghost",this._ghostDeathListener)}},{key:"stop",value:function(){}},{key:"calculatePlayerAverageRatio",value:function(){var a=this.entityStats.get("pacman");return a.calculateAverageRatio()}},{key:"calculateTopGhostAverageRatio",value:function(){var a=[this.entityStats.get("blinky"),this.entityStats.get("pinky"),this.entityStats.get("inky"),this.entityStats.get("clyde")],b=a.reduce(function(a,b){return a.calculateAverageRatio()>b.calculateAverageRatio()?a:b},a[0]);return{name:b.name,ratio:b.calculateAverageRatio()}}},{key:"_handlePacmanDeath",value:function(a){var b=this.entityStats.get("pacman");b.incrementDeaths(this._currentRound);var c=this.entityStats.get(a);c.incrementKills(this._currentRound)}},{key:"_handleGhostDeath",value:function(a){var b=this.entityStats.get("pacman");b.incrementKills(this._currentRound);var c=this.entityStats.get(a);c.incrementDeaths(this._currentRound)}}]),a}(),j=new i;b.exports=j},{"./config":5,"./event-bus":9}],30:[function(a,b,c){"use strict";function d(a){return"red"===a?[1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,.5,0]:"pink"===a?[1,1,0,0,0,0,.72,0,0,0,0,1,1,0,0,0,0,0,.5,0]:"blue"===a?[1,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,.5,0]:"orange"===a?[1,1,0,0,0,0,.73,0,0,0,0,.31,1,0,0,0,0,0,.5,0]:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,.5,0]}var e=a("./config");c.convertToTileSpace=function(a){return Math.floor(a/e.wallSize)},c.overlap=function(a,b,c,d,e,f,g,h){return g>a&&c>e&&h>b&&d>f},c.getRandomIntInclusive=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},c.qs=function(a,b){return a*a+b*b},c.generateColorMatrixValue=d,c.createPacmanIcon=function(a){var b=PIXI.Texture.fromFrame("player2.png"),c=new PIXI.Sprite(b);return c.scale.x=c.scale.y=a,c},c.createGhostIcon=function(a,b){var c=PIXI.Texture.fromFrame("shade-green-right1.png"),e=new PIXI.Sprite(c);e.scale.x=e.scale.y=b;var f=new PIXI.filters.ColorMatrixFilter;return f.matrix=d(a),e.filters=[f],e}},{"./config":5}]},{},[18]);